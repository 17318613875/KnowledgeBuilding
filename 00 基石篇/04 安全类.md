# 安全类

## XSS

跨站脚本攻击：通过对网页注入可执行代码且成功地被浏览器执行达到攻击的目的，形成了一次有效XSS攻击

**攻击条件**:

1. 需要向web页面注入恶意代码;
2. 这些恶意代码能够被浏览器成功的执行。

类型    |触发过程   |数据存储   |输出对象   |输出位置
--------|----------|----------|-----------|--------------
反射式漏洞|通过引诱用户点击一个携带XSS脚本的Url|URL|后端Web应用程序|HTTP响应中
存储式漏洞|用户访问携带XSS脚本的页面|数据库|后端Web应用程序|HTTP响应中
DOM式漏洞|通过引诱用户点击一个携带XSS脚本的Url|URL|前端JavaScript|动态构建DOM节点

**处置对策**:

* 在表单提交或者url参数传递前，对需要的参数进行过滤;

* 过滤用户输入的检查用户输入的内容中是否有非法内容:
    1. htmlspecialchars() 函数,用于转义处理在页面上显示的文本;
    2. htmlentities() 函数,用于转义处理在页面上显示的文本。
    3. strip_tags() 函数,过滤掉输入、输出里面的恶意标签。
    4. header() 函数,使用header("Content-type:application/json"); 用于控制 json 数据的头部，不用于浏览。
    5. urlencode() 函数,用于输出处理字符型参数带入页面链接中。
    6. intval() 函数用于处理数值型参数输出页面中。
    7. 自定义函数,在大多情况下，要使用一些常用的 html 标签，以美化页面显示，如留言、小纸条。那么在这样的情况下，要采用白名单的方法使用合法的标签显示，过滤掉非法的字符

## SQL注入

SQL注入是一种注入攻击，可以执行恶意SQL语句，它通过将任意SQL代码插入数据库查询，使攻击者能够完全控制Web应用程序后面的数据库服务器

**攻击条件**:

1. 依赖于攻击者修改应用程序发送的SQL；
2. 以及浏览器中显示的错误和返回的信息;

类型        |触发过程
-----------|--------
带内注入    |1. 基于错误的SQL注入：从显示的错误消息中获取有关数据库的信息<br/>2. 基于联合的SQL注入：依赖于攻击者能够将UNION ALL被盗信息的结果与合法结果连接起来
盲注入      |推理SQL注入
带外注入    |1. 制作SQL语句，在呈现给数据库时会触发数据库系统创建与攻击者控制的外部服务器的连接，攻击者可以收集数据或可能控制数据库的行为<br/>2. 攻击者将提供SQL注入，该注入将由数据库系统的单独行为存储和执行。

**处置对策**:

1. 不要使用动态SQL;
2. 不要将敏感数据保留在纯文本中;
3. 限制数据库权限和特权;
4. 避免直接向用户显示数据库错误;
5. 对访问数据库的Web应用程序使用Web应用程序防火墙（WAF）;
6. 定期测试与数据库交互的Web应用程序;
7. 将数据库更新为最新的可用修补程序。
